/*! For license information please see versions-sidebar.5140005ed7e9fe749798.bundle.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{3906:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(17);var react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),_inline_notice__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(671);function _extends(){return(_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}var InlineError=function(props){return react__WEBPACK_IMPORTED_MODULE_1__.createElement(_inline_notice__WEBPACK_IMPORTED_MODULE_2__.a,_extends({},props,{type:"error"}))};InlineError.displayName="InlineError",__webpack_exports__.a=InlineError},3908:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__(17);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),index_es=__webpack_require__(4),constants=__webpack_require__(1),datetime=__webpack_require__(250),time_messages=Object(index_es.f)({eventTime:{id:"boxui.readableTime.eventTime",defaultMessage:"{time, date, medium}"},eventTimeToday:{id:"boxui.readableTime.eventTimeToday",defaultMessage:"Today at {time, time, short}"},eventTimeYesterday:{id:"boxui.readableTime.eventTimeYesterday",defaultMessage:"Yesterday at {time, time, short}"},eventTimeDate:{id:"boxui.readableTime.eventTimeDate",defaultMessage:"{time, date, medium} at {time, time, short}"},eventTimeDateShort:{id:"boxui.readableTime.eventTimeDateShort",defaultMessage:"{date} at {time, time, short}"},eventTimeWeekdayLong:{id:"boxui.readableTime.eventTimeWeekdayLong",defaultMessage:"{weekday}, {time, date, medium}"}});function _extends(){return(_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}__webpack_exports__.a=function(_ref){var timestamp=_ref.timestamp,_ref$relativeThreshol=_ref.relativeThreshold,relativeThreshold=void 0===_ref$relativeThreshol?constants.Gd:_ref$relativeThreshol,_ref$allowFutureTimes=_ref.allowFutureTimestamps,allowFutureTimestamps=void 0===_ref$allowFutureTimes||_ref$allowFutureTimes,_ref$alwaysShowTime=_ref.alwaysShowTime,alwaysShowTime=void 0!==_ref$alwaysShowTime&&_ref$alwaysShowTime,_ref$showWeekday=_ref.showWeekday,showWeekday=void 0!==_ref$showWeekday&&_ref$showWeekday,relativeIfNewerThanTs=Date.now()-relativeThreshold,shouldShowYear=!Object(datetime.h)(timestamp);!allowFutureTimestamps&&timestamp>Date.now()&&(timestamp=relativeIfNewerThanTs);var dateMessage=time_messages.eventTime,date=null,weekday=null;if(Object(datetime.i)(timestamp))dateMessage=time_messages.eventTimeToday;else if(Object(datetime.j)(timestamp))dateMessage=time_messages.eventTimeYesterday;else if(showWeekday)dateMessage=time_messages.eventTimeWeekdayLong,weekday=react_default.a.createElement(index_es.a,{value:timestamp,weekday:"long"});else if(shouldShowYear&&alwaysShowTime)dateMessage=time_messages.eventTimeDate;else if(!shouldShowYear&&alwaysShowTime)dateMessage=time_messages.eventTimeDateShort,date=react_default.a.createElement(index_es.a,{value:timestamp,month:"short",day:"numeric"});else if(!shouldShowYear&&!alwaysShowTime)return react_default.a.createElement(index_es.a,{value:timestamp,month:"short",day:"numeric"});var output=react_default.a.createElement(index_es.b,_extends({},dateMessage,{values:{time:timestamp,date:date,weekday:weekday}}));return Math.abs(Date.now()-timestamp)<=relativeThreshold&&(output=react_default.a.createElement(index_es.d,{value:timestamp})),output}},3912:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_styles_variables__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(2),_accessible_svg__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(13),IconTrash=function(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$color=_ref.color,color=void 0===_ref$color?_styles_variables__WEBPACK_IMPORTED_MODULE_1__.bdlGray80:_ref$color,_ref$height=_ref.height,height=void 0===_ref$height?16:_ref$height,title=_ref.title,_ref$width=_ref.width,width=void 0===_ref$width?16:_ref$width;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_accessible_svg__WEBPACK_IMPORTED_MODULE_2__.a,{className:"icon-trash ".concat(className),height:height,title:title,viewBox:"0 0 16 16",width:width},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{className:"fill-color",fill:color,fillRule:"evenodd",d:"M14 2l-1.8 11c-.1.6-.7 1-1.2 1H5c-.6 0-1.1-.5-1.2-1L2 2h12zm-1.2 1H3.2l1.6 9.9s.1.1.2.1h6c.06 0 .12-.036.158-.065l.042-.035L12.8 3zm-2.3 1c.3 0 .5.2.5.5s-.2.5-.5.5h-5c-.3 0-.5-.2-.5-.5s.2-.5.5-.5z"}))};IconTrash.displayName="IconTrash",__webpack_exports__.a=IconTrash},3913:function(module,__webpack_exports__,__webpack_require__){"use strict";var _constants__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1);__webpack_exports__.a={getVersionAction:function(_ref){var restored_at=_ref.restored_at,trashed_at=_ref.trashed_at,version_promoted=_ref.version_promoted,action=_constants__WEBPACK_IMPORTED_MODULE_0__.df;return trashed_at&&(action=_constants__WEBPACK_IMPORTED_MODULE_0__.Xe),restored_at&&(action=_constants__WEBPACK_IMPORTED_MODULE_0__.Ze),version_promoted&&(action=_constants__WEBPACK_IMPORTED_MODULE_0__.Ye),action},getVersionUser:function(_ref2){var modified_by=_ref2.modified_by,restored_by=_ref2.restored_by,trashed_by=_ref2.trashed_by;return restored_by||trashed_by||modified_by||_constants__WEBPACK_IMPORTED_MODULE_0__.be}}},3914:function(module,__webpack_exports__,__webpack_require__){"use strict";var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_accessible_svg__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(13),_styles_variables__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2),IconOpenWith=function(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$color=_ref.color,color=void 0===_ref$color?_styles_variables__WEBPACK_IMPORTED_MODULE_2__.bdlGray80:_ref$color,_ref$height=_ref.height,height=void 0===_ref$height?16:_ref$height,title=_ref.title,_ref$width=_ref.width,width=void 0===_ref$width?16:_ref$width;return react__WEBPACK_IMPORTED_MODULE_0__.createElement(_accessible_svg__WEBPACK_IMPORTED_MODULE_1__.a,{className:"icon-open-with ".concat(className),height:height,title:title,viewBox:"0 0 16 16",width:width},react__WEBPACK_IMPORTED_MODULE_0__.createElement("path",{className:"fill-color",fill:color,fillRule:"evenodd",d:"M12 2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm0 1H4a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1zm-1 2v6h-1V6.71l-4.65 4.64-.7-.7L9.29 6H5V5h6z"}))};IconOpenWith.displayName="IconOpenWith",__webpack_exports__.a=IconOpenWith},3918:function(module,__webpack_exports__,__webpack_require__){"use strict";var _ReadableTime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3908);__webpack_require__.d(__webpack_exports__,"a",(function(){return _ReadableTime__WEBPACK_IMPORTED_MODULE_0__.a}))},3922:function(module,__webpack_exports__,__webpack_require__){"use strict";var _InlineError__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3906);__webpack_require__.d(__webpack_exports__,"a",(function(){return _InlineError__WEBPACK_IMPORTED_MODULE_0__.a}))},3999:function(module,exports,__webpack_require__){},4e3:function(module,exports,__webpack_require__){},4001:function(module,exports,__webpack_require__){},4002:function(module,exports,__webpack_require__){},4003:function(module,exports,__webpack_require__){},4004:function(module,exports,__webpack_require__){},4005:function(module,exports,__webpack_require__){},4006:function(module,exports,__webpack_require__){},4007:function(module,exports,__webpack_require__){},4013:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(9),__webpack_require__(14),__webpack_require__(19),__webpack_require__(22),__webpack_require__(27),__webpack_require__(409),__webpack_require__(128),__webpack_require__(12),__webpack_require__(28),__webpack_require__(17),__webpack_require__(38),__webpack_require__(39),__webpack_require__(20),__webpack_require__(18),__webpack_require__(10),__webpack_require__(47),__webpack_require__(16),__webpack_require__(410),__webpack_require__(30),__webpack_require__(15);var react=__webpack_require__(0),react_default=__webpack_require__.n(react),flow=__webpack_require__(670),flow_default=__webpack_require__.n(flow),get=__webpack_require__(21),get_default=__webpack_require__.n(get),merge=__webpack_require__(1900),merge_default=__webpack_require__.n(merge),noop=__webpack_require__(11),noop_default=__webpack_require__.n(noop),react_router=__webpack_require__(3904),index_es=(__webpack_require__(358),__webpack_require__(4)),versions_messages=Object(index_es.f)({versionsEmpty:{id:"be.sidebarVersions.empty",defaultMessage:"No prior versions are available for this file."},versionsPriorWeek:{id:"be.sidebarVersions.priorWeek",defaultMessage:"Last Week"},versionsThisMonth:{id:"be.sidebarVersions.thisMonth",defaultMessage:"This Month"},versionsToday:{id:"be.sidebarVersions.today",defaultMessage:"Today"},versionsYesterday:{id:"be.sidebarVersions.yesterday",defaultMessage:"Yesterday"},versionsTitle:{id:"be.sidebarVersions.title",defaultMessage:"Version History"},versionCurrent:{id:"be.sidebarVersions.current",defaultMessage:"Current Version"},versionActionDelete:{id:"be.sidebarVersions.delete",defaultMessage:"Delete"},versionActionDeleteError:{id:"be.sidebarVersions.deleteError",defaultMessage:"File version could not be deleted."},versionActionDisabledRetention:{id:"be.sidebarVersions.disabledByRetention",defaultMessage:"Disabled by retention policy"},versionActionDownload:{id:"be.sidebarVersions.download",defaultMessage:"Download"},versionActionDownloadError:{id:"be.sidebarVersions.downloadError",defaultMessage:"File version could not be downloaded."},versionActionPreview:{id:"be.sidebarVersions.preview",defaultMessage:"Preview"},versionActionPromote:{id:"be.sidebarVersions.promote",defaultMessage:"Make Current"},versionActionPromoteError:{id:"be.sidebarVersions.promoteError",defaultMessage:"File version could not be made current."},versionActionRestore:{id:"be.sidebarVersions.restore",defaultMessage:"Restore"},versionActionRestoreError:{id:"be.sidebarVersions.restoreError",defaultMessage:"File version could not be restored."},versionActionToggle:{id:"be.sidebarVersions.toggle",defaultMessage:"Toggle Actions Menu"},versionDeletedBy:{id:"be.sidebarVersions.deletedBy",defaultMessage:"Deleted by {name}"},versionFetchError:{id:"be.sidebarVersions.fetchError",defaultMessage:"File versions could not be retrieved."},versionLimitExceeded:{id:"be.sidebarVersions.versionLimitExceeded",defaultMessage:"You are limited to the last {versionLimit, number} {versionLimit, plural, one {version} other {versions}}."},versionNumberBadge:{id:"be.sidebarVersions.versionNumberBadge",defaultMessage:"V{versionNumber}"},versionNumberLabel:{id:"be.sidebarVersions.versionNumberLabel",defaultMessage:"Version number {versionNumber}"},versionPromotedBy:{id:"be.sidebarVersions.promotedBy",defaultMessage:"Promoted from v{versionPromoted} by {name}"},versionRestoredBy:{id:"be.sidebarVersions.restoredBy",defaultMessage:"Restored by {name}"},versionServerError:{id:"be.sidebarVersions.serverError",defaultMessage:"Server Error"},versionUploadedBy:{id:"be.sidebarVersions.uploadedBy",defaultMessage:"Uploaded by {name}"},versionUserUnknown:{id:"be.sidebarVersions.versionUserUnknown",defaultMessage:"Unknown"},versionMaxEntries:{id:"be.sidebarVersions.versionMaxEntries",defaultMessage:"Version history is limited to the last {maxVersions} entries."},versionRetentionDelete:{id:"be.sidebarVersions.versionRetentionDelete",defaultMessage:"Will be deleted {time} by retention policy."},versionRetentionIndefinite:{id:"be.sidebarVersions.versionRetentionIndefinite",defaultMessage:"Retained indefinitely by retention policy."},versionRetentionRemove:{id:"be.sidebarVersions.versionRetentionRemove",defaultMessage:"Retention policy expires on {time}."}}),iframe=__webpack_require__(1934),inline_error=__webpack_require__(3922),SidebarContent=__webpack_require__(3909),last=__webpack_require__(1989),last_default=__webpack_require__.n(last),datetime=__webpack_require__(250),selectors_version=(__webpack_require__(24),__webpack_require__(3913)),utils_size=__webpack_require__(877),dropdown_menu=__webpack_require__(110),accessible_svg=__webpack_require__(13),IconClockPast=function(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$color=_ref.color,color=void 0===_ref$color?"#444":_ref$color,_ref$height=_ref.height,height=void 0===_ref$height?14:_ref$height,title=_ref.title,_ref$width=_ref.width,width=void 0===_ref$width?16:_ref$width;return react.createElement(accessible_svg.a,{className:"icon-clock-past ".concat(className),height:height,title:title,viewBox:"0 0 16 14",width:width},react.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(0 1)"},react.createElement("rect",{className:"fill-color",fill:color,height:"5",rx:".5",width:"1",x:"9.66",y:"3"}),react.createElement("rect",{className:"fill-color",fill:color,height:"1",rx:".5",width:"3",x:"9.66",y:"7"}),react.createElement("path",{className:"stroke-color",d:"M5.66 10.62C6.697 11.48 8.032 12 9.487 12c3.314 0 6-2.686 6-6s-2.686-6-6-6c-3.313 0-6 2.686-6 6",stroke:color,strokeLinecap:"round",strokeLinejoin:"round"}),react.createElement("path",{className:"fill-color",d:"M6.317 5l-2.83 2.828L.66 5",fill:color})))};IconClockPast.displayName="IconClockPast";var general_IconClockPast=IconClockPast,variables=__webpack_require__(2),IconDownload=function(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$color=_ref.color,color=void 0===_ref$color?variables.bdlGray80:_ref$color,_ref$height=_ref.height,height=void 0===_ref$height?16:_ref$height,title=_ref.title,_ref$width=_ref.width,width=void 0===_ref$width?16:_ref$width;return react.createElement(accessible_svg.a,{className:"icon-download ".concat(className),height:height,title:title,viewBox:"0 0 16 16",width:width},react.createElement("path",{className:"fill-color",fill:color,fillRule:"evenodd",d:"M14 14v1H2v-1h12zM10.996 2v4.997H14L8 13 2 6.997h3.004V2h5.992zm-.998 1H6.002v4.996h-1.59L8 11.586l3.589-3.59H9.998V3z"}))};IconDownload.displayName="IconDownload";var general_IconDownload=IconDownload,IconEllipsis=__webpack_require__(1243),IconOpenWith=__webpack_require__(3914),IconTrash=__webpack_require__(3912),IconUpload=function(_ref){var _ref$className=_ref.className,className=void 0===_ref$className?"":_ref$className,_ref$color=_ref.color,color=void 0===_ref$color?variables.bdlGray80:_ref$color,_ref$height=_ref.height,height=void 0===_ref$height?16:_ref$height,title=_ref.title,_ref$width=_ref.width,width=void 0===_ref$width?16:_ref$width;return react.createElement(accessible_svg.a,{className:"icon-upload ".concat(className),height:height,title:title,viewBox:"0 0 16 16",width:width},react.createElement("path",{className:"fill-color",fill:color,fillRule:"evenodd",d:"M14 14v1H2v-1h12zM8 1l6 6.003h-3.004V12H5.004V7.003H2L8 1zm0 1.413l-3.589 3.59h1.591v4.998h3.996V6.004h1.59L8 2.414z"}))};IconUpload.displayName="IconUpload";var general_IconUpload=IconUpload,plain_button=__webpack_require__(48),Tooltip=__webpack_require__(109),menu=__webpack_require__(46);__webpack_require__(3999);function _extends(){return(_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],0<=excluded.indexOf(key)||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var VersionsItemAction_VersionsItemAction=function(_ref){var action=_ref.action,children=_ref.children,fileId=_ref.fileId,isCurrent=_ref.isCurrent,rest=_objectWithoutProperties(_ref,["action","children","fileId","isCurrent"]);return react.createElement(menu.b,_extends({className:"bcs-VersionsItemAction","data-resin-iscurrent":isCurrent,"data-resin-itemid":fileId,"data-resin-target":action},rest),children)};VersionsItemAction_VersionsItemAction.displayName="VersionsItemAction";var versions_VersionsItemAction=VersionsItemAction_VersionsItemAction,handleMenuClose=(__webpack_require__(4e3),function(event){event.stopPropagation()}),handleToggleClick=function(event){event.stopPropagation()},VersionsItemActions_ref2=react.createElement(IconEllipsis.a,{height:4,width:14}),VersionsItemActions_ref3=react.createElement(IconOpenWith.a,null),VersionsItemActions_ref4=react.createElement(general_IconDownload,null),_ref5=react.createElement(general_IconUpload,null),_ref6=react.createElement(general_IconClockPast,{height:14,width:14}),_ref7=react.createElement(IconTrash.a,null),VersionsItemActions_VersionsItemActions=function(_ref){var fileId=_ref.fileId,_ref$isCurrent=_ref.isCurrent,isCurrent=void 0!==_ref$isCurrent&&_ref$isCurrent,_ref$isRetained=_ref.isRetained,isRetained=void 0!==_ref$isRetained&&_ref$isRetained,onDelete=_ref.onDelete,onDownload=_ref.onDownload,onPreview=_ref.onPreview,onPromote=_ref.onPromote,onRestore=_ref.onRestore,_ref$showDelete=_ref.showDelete,showDelete=void 0!==_ref$showDelete&&_ref$showDelete,_ref$showDownload=_ref.showDownload,showDownload=void 0!==_ref$showDownload&&_ref$showDownload,_ref$showPreview=_ref.showPreview,showPreview=void 0!==_ref$showPreview&&_ref$showPreview,_ref$showPromote=_ref.showPromote,showPromote=void 0!==_ref$showPromote&&_ref$showPromote,_ref$showRestore=_ref.showRestore,showRestore=void 0!==_ref$showRestore&&_ref$showRestore;return showDelete||showDownload||showPreview||showPromote||showRestore?react.createElement(dropdown_menu.b,{className:"bcs-VersionsItemActions",constrainToScrollParent:!0,constrainToWindow:!0,isRightAligned:!0,onMenuClose:handleMenuClose},react.createElement(plain_button.a,{className:"bcs-VersionsItemActions-toggle","data-resin-iscurrent":isCurrent,"data-resin-itemid":fileId,"data-resin-target":"overflow",onClick:handleToggleClick,type:"button"},VersionsItemActions_ref2,react.createElement(index_es.b,versions_messages.versionActionToggle,(function(text){return react.createElement("span",{className:"accessibility-hidden"},text)}))),react.createElement(menu.a,{className:"bcs-VersionsItemActions-menu","data-resin-component":"preview","data-resin-feature":"versions"},showPreview&&react.createElement(versions_VersionsItemAction,{action:"preview",fileId:fileId,isCurrent:isCurrent,onClick:onPreview},VersionsItemActions_ref3,react.createElement(index_es.b,versions_messages.versionActionPreview)),showDownload&&react.createElement(versions_VersionsItemAction,{action:"download",fileId:fileId,isCurrent:isCurrent,onClick:onDownload},VersionsItemActions_ref4,react.createElement(index_es.b,versions_messages.versionActionDownload)),showPromote&&react.createElement(versions_VersionsItemAction,{action:"promote",fileId:fileId,isCurrent:isCurrent,onClick:onPromote},_ref5,react.createElement(index_es.b,versions_messages.versionActionPromote)),showRestore&&react.createElement(versions_VersionsItemAction,{action:"restore",fileId:fileId,isCurrent:isCurrent,onClick:onRestore},_ref6,react.createElement(index_es.b,versions_messages.versionActionRestore)),showDelete&&react.createElement(Tooltip.a,{position:"middle-left",text:react.createElement(index_es.b,versions_messages.versionActionDisabledRetention),isTabbable:!1,isDisabled:!isRetained},react.createElement(versions_VersionsItemAction,{action:"remove",fileId:fileId,isCurrent:isCurrent,isDisabled:isRetained,onClick:onDelete},_ref7,react.createElement(index_es.b,versions_messages.versionActionDelete))))):null};VersionsItemActions_VersionsItemActions.displayName="VersionsItemActions";var versions_VersionsItemActions=VersionsItemActions_VersionsItemActions,classnames=__webpack_require__(8),classnames_default=__webpack_require__.n(classnames),dom=__webpack_require__(89);__webpack_require__(4001);function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)(descriptor=props[i]).enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var VersionsItemButton_VersionsItemButton=function(_React$Component){function VersionsItemButton(){var _getPrototypeOf2,_this;_classCallCheck(this,VersionsItemButton);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _defineProperty(_assertThisInitialized(_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(VersionsItemButton)).call.apply(_getPrototypeOf2,[this].concat(args)))),"setButtonRef",(function(buttonRef){_this.buttonRef=buttonRef})),_defineProperty(_assertThisInitialized(_this),"setScroll",(function(){var isSelected=_this.props.isSelected;_this.buttonRef&&isSelected&&Object(dom.e)(_this.buttonRef)})),_this}return function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(VersionsItemButton,_React$Component),function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(VersionsItemButton,[{key:"componentDidMount",value:function componentDidMount(){this.setScroll()}},{key:"componentDidUpdate",value:function componentDidUpdate(_ref){var prevIsSelected=_ref.isSelected;this.props.isSelected!==prevIsSelected&&this.setScroll()}},{key:"render",value:function render(){var _this$props=this.props,children=_this$props.children,fileId=_this$props.fileId,isCurrent=_this$props.isCurrent,isDisabled=_this$props.isDisabled,isSelected=_this$props.isSelected,onClick=_this$props.onClick,buttonClassName=classnames_default()("bcs-VersionsItemButton",{"bcs-is-disabled":isDisabled,"bcs-is-selected":isSelected&&!isDisabled});return react.createElement(plain_button.a,{"aria-disabled":isDisabled,className:buttonClassName,"data-resin-iscurrent":isCurrent,"data-resin-itemid":fileId,"data-resin-target":"select","data-testid":"versions-item-button",getDOMRef:this.setButtonRef,isDisabled:isDisabled,onClick:onClick,type:"button"},children)}}]),VersionsItemButton}(react.Component);VersionsItemButton_VersionsItemButton.displayName="VersionsItemButton",_defineProperty(VersionsItemButton_VersionsItemButton,"defaultProps",{isCurrent:!1,isDisabled:!1,isSelected:!1});var content_sidebar_versions_VersionsItemButton=VersionsItemButton_VersionsItemButton;__webpack_require__(4002);function VersionsItemBadge_extends(){return(VersionsItemBadge_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}var VersionsItemBadge_VersionsItemBadge=function(_ref){var intl=_ref.intl,intlValues={versionNumber:_ref.versionNumber};return react.createElement("div",{"aria-label":intl.formatMessage(versions_messages.versionNumberLabel,intlValues),className:"bcs-VersionsItemBadge"},react.createElement(index_es.b,VersionsItemBadge_extends({},versions_messages.versionNumberBadge,{values:intlValues})))};VersionsItemBadge_VersionsItemBadge.displayName="VersionsItemBadge";var _RETENTION_MAP,versions_VersionsItemBadge=Object(index_es.g)(VersionsItemBadge_VersionsItemBadge),time=__webpack_require__(3918),constants=__webpack_require__(1);function VersionsItemRetention_extends(){return(VersionsItemRetention_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function VersionsItemRetention_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _ACTION_MAP,RETENTION_MAP=(VersionsItemRetention_defineProperty(_RETENTION_MAP={},constants.af,versions_messages.versionRetentionDelete),VersionsItemRetention_defineProperty(_RETENTION_MAP,constants.cf,versions_messages.versionRetentionRemove),_RETENTION_MAP),versions_VersionsItemRetention=function(_ref){var _ref2=_ref.retention||{},dispositionAt=_ref2.disposition_at,_ref3=_ref2.winning_retention_policy||{},dispositionAction=_ref3.disposition_action,retentionLength=_ref3.retention_length,dispositionAtTime=dispositionAt&&new Date(dispositionAt).getTime();return dispositionAction?retentionLength!==constants.bf&&dispositionAtTime?react.createElement(index_es.b,VersionsItemRetention_extends({},RETENTION_MAP[dispositionAction],{values:{time:react.createElement(time.a,{timestamp:dispositionAtTime,showWeekday:!0})}})):react.createElement(index_es.b,versions_messages.versionRetentionIndefinite):null};__webpack_require__(4003);function VersionsItem_extends(){return(VersionsItem_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function VersionsItem_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ACTION_MAP=(VersionsItem_defineProperty(_ACTION_MAP={},constants.Xe,versions_messages.versionDeletedBy),VersionsItem_defineProperty(_ACTION_MAP,constants.Ze,versions_messages.versionRestoredBy),VersionsItem_defineProperty(_ACTION_MAP,constants.Ye,versions_messages.versionPromotedBy),VersionsItem_defineProperty(_ACTION_MAP,constants.df,versions_messages.versionUploadedBy),_ACTION_MAP),VersionsItem_VersionsItem=function(_ref){var fileId=_ref.fileId,_ref$isCurrent=_ref.isCurrent,isCurrent=void 0!==_ref$isCurrent&&_ref$isCurrent,_ref$isSelected=_ref.isSelected,isSelected=void 0!==_ref$isSelected&&_ref$isSelected,_ref$isWatermarked=_ref.isWatermarked,isWatermarked=void 0!==_ref$isWatermarked&&_ref$isWatermarked,onDelete=_ref.onDelete,onDownload=_ref.onDownload,onPreview=_ref.onPreview,onPromote=_ref.onPromote,onRestore=_ref.onRestore,version=_ref.version,versionCount=_ref.versionCount,versionLimit=_ref.versionLimit,createdAt=version.created_at,versionId=version.id,is_download_available=version.is_download_available,_version$permissions=version.permissions,permissions=void 0===_version$permissions?{}:_version$permissions,restoredAt=version.restored_at,retention=version.retention,size=version.size,trashedAt=version.trashed_at,versionNumber=version.version_number,versionPromoted=version.version_promoted,can_delete=permissions.can_delete,can_download=permissions.can_download,can_preview=permissions.can_preview,can_upload=permissions.can_upload,_ref2=retention||{},retentionAppliedAt=_ref2.applied_at,retentionDispositionAt=_ref2.disposition_at,retentionDispositionAtDate=retentionDispositionAt&&new Date(retentionDispositionAt),versionAction=selectors_version.a.getVersionAction(version),versionInteger=versionNumber?parseInt(versionNumber,10):1,versionTime=restoredAt||trashedAt||createdAt,versionTimestamp=versionTime&&new Date(versionTime).getTime(),versionUserName=selectors_version.a.getVersionUser(version).name||react.createElement(index_es.b,versions_messages.versionUserUnknown),isDeleted=versionAction===constants.Xe,isLimited=versionCount-versionInteger>=versionLimit,isRetained=!!retentionAppliedAt&&(!retentionDispositionAtDate||retentionDispositionAtDate>new Date),canPreview=can_preview&&!isDeleted&&!isLimited&&!(isWatermarked&&!isCurrent),showDelete=can_delete&&!isDeleted&&!isCurrent,showDownload=can_download&&!isDeleted&&!!is_download_available,showPromote=can_upload&&!isDeleted&&!isCurrent,showRestore=can_delete&&isDeleted,showPreview=canPreview&&!isSelected,hasActions=showDelete||showDownload||showPreview||showPromote||showRestore,handleAction=function(handler){return function(){handler&&handler(versionId)}};return react.createElement("div",{className:"bcs-VersionsItem"},react.createElement(content_sidebar_versions_VersionsItemButton,{fileId:fileId,isCurrent:isCurrent,isDisabled:!canPreview,isSelected:isSelected,onClick:handleAction(onPreview)},react.createElement("div",{className:"bcs-VersionsItem-badge"},react.createElement(versions_VersionsItemBadge,{versionNumber:versionNumber})),react.createElement("div",{className:"bcs-VersionsItem-details"},isCurrent&&react.createElement("div",{className:"bcs-VersionsItem-current"},react.createElement(index_es.b,versions_messages.versionCurrent)),react.createElement("div",{className:"bcs-VersionsItem-log","data-testid":"bcs-VersionsItem-log",title:versionUserName},react.createElement(index_es.b,VersionsItem_extends({},ACTION_MAP[versionAction],{values:{name:versionUserName,versionPromoted:versionPromoted}}))),react.createElement("div",{className:"bcs-VersionsItem-info"},versionTimestamp&&react.createElement("time",{className:"bcs-VersionsItem-date",dateTime:versionTime},react.createElement(time.a,{alwaysShowTime:!0,relativeThreshold:3e5,timestamp:versionTimestamp})),!!size&&react.createElement("span",{className:"bcs-VersionsItem-size"},Object(utils_size.a)(size))),isRetained&&react.createElement("div",{className:"bcs-VersionsItem-retention"},react.createElement(versions_VersionsItemRetention,{retention:retention})),isLimited&&hasActions&&react.createElement("div",{className:"bcs-VersionsItem-footer"},react.createElement(index_es.b,VersionsItem_extends({},versions_messages.versionLimitExceeded,{values:{versionLimit:versionLimit}}))))),!isLimited&&hasActions&&react.createElement(versions_VersionsItemActions,{fileId:fileId,isCurrent:isCurrent,isRetained:isRetained,onDelete:handleAction(onDelete),onDownload:handleAction(onDownload),onPreview:handleAction(onPreview),onPromote:handleAction(onPromote),onRestore:handleAction(onRestore),showDelete:showDelete,showDownload:showDownload,showPreview:showPreview,showPromote:showPromote,showRestore:showRestore}))};VersionsItem_VersionsItem.displayName="VersionsItem";var versions_VersionsItem=VersionsItem_VersionsItem;__webpack_require__(4004);function VersionsList_extends(){return(VersionsList_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function VersionsList_objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function VersionsList_objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],0<=excluded.indexOf(key)||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var VersionsList_VersionsList=function(_ref){var currentId=_ref.currentId,versions=_ref.versions,rest=VersionsList_objectWithoutProperties(_ref,["currentId","versions"]);return react_default.a.createElement("ul",{className:"bcs-VersionsList"},versions.map((function(version){return react_default.a.createElement("li",{className:"bcs-VersionsList-item",key:version.id},react_default.a.createElement(react_router.c,{render:function render(_ref2){var match=_ref2.match;return react_default.a.createElement(versions_VersionsItem,VersionsList_extends({isCurrent:currentId===version.id,isSelected:match.params.versionId===version.id,version:version},rest))}}))})))};VersionsList_VersionsList.displayName="VersionsList";var versions_VersionsList=VersionsList_VersionsList;__webpack_require__(4005);function VersionsGroup_objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function VersionsGroup_objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],0<=excluded.indexOf(key)||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var VersionsGroup_VersionsGroup=function(_ref){var heading=_ref.heading,rest=VersionsGroup_objectWithoutProperties(_ref,["heading"]);return react_default.a.createElement("section",{className:"bcs-VersionsGroup"},react_default.a.createElement("h1",{className:"bcs-VersionsGroup-heading"},heading),react_default.a.createElement(versions_VersionsList,rest))};VersionsGroup_VersionsGroup.displayName="VersionsGroup";var versions_VersionsGroup=VersionsGroup_VersionsGroup;__webpack_require__(4006);function VersionsMenu_extends(){return(VersionsMenu_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function VersionsMenu_objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function VersionsMenu_objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],0<=excluded.indexOf(key)||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var VersionsMenu_VersionsMenu=react_default.a.memo((function(_ref2){var intl=_ref2.intl,versions=_ref2.versions,rest=VersionsMenu_objectWithoutProperties(_ref2,["intl","versions"]),currentId=(versions[0]||{}).id,versionGroups=versions.reduce((function(groups,version){var currentGroup=last_default()(groups),groupHeading=function(_ref){var intl=_ref.intl,createdAt=_ref.version.created_at,currentDate=new Date,currentDay=currentDate.getDay(),currentSunday=currentDate.getDate()-currentDay,createdAtDate=datetime.d(createdAt);return datetime.i(createdAtDate)?intl.formatMessage(versions_messages.versionsToday):datetime.j(createdAtDate)?intl.formatMessage(versions_messages.versionsYesterday):datetime.h(createdAtDate)?datetime.g(createdAtDate)?createdAtDate.getDate()<=currentSunday-7?intl.formatMessage(versions_messages.versionsThisMonth):createdAtDate.getDate()<=currentSunday?intl.formatMessage(versions_messages.versionsPriorWeek):intl.formatDate(createdAt,{weekday:"long"}):intl.formatDate(createdAt,{month:"long"}):intl.formatDate(createdAt,{year:"numeric"})}({intl:intl,version:version});return currentGroup&&currentGroup.groupHeading===groupHeading||groups.push({groupHeading:groupHeading,groupVersions:[]}),last_default()(groups).groupVersions.push(version),groups}),[]);return react_default.a.createElement("ul",{className:"bcs-VersionsMenu"},versionGroups.map((function(_ref4){var groupHeading=_ref4.groupHeading,groupVersions=_ref4.groupVersions;return react_default.a.createElement("li",{className:"bcs-VersionsMenu-item",key:groupHeading},react_default.a.createElement(versions_VersionsGroup,VersionsMenu_extends({currentId:currentId,heading:groupHeading,versions:groupVersions},rest)))})))})),versions_VersionsMenu=Object(index_es.g)(VersionsMenu_VersionsMenu),nav_button=__webpack_require__(3926),loading_indicator=__webpack_require__(314);__webpack_require__(4007);function VersionsSidebar_extends(){return(VersionsSidebar_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function VersionsSidebar_objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function VersionsSidebar_objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],0<=excluded.indexOf(key)||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],0<=excluded.indexOf(key)||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var MAX_VERSIONS=constants.F,VersionsSidebar_VersionsSidebar=function(_ref){var error=_ref.error,isLoading=_ref.isLoading,parentName=_ref.parentName,versions=_ref.versions,rest=VersionsSidebar_objectWithoutProperties(_ref,["error","isLoading","parentName","versions"]),showLimit=versions.length>=MAX_VERSIONS,showVersions=!!versions.length;return react.createElement(SidebarContent.a,{className:"bcs-Versions","data-resin-component":"preview","data-resin-feature":"versions",title:react.createElement(react.Fragment,null,react.createElement(nav_button.a,{"data-resin-target":"back",to:"/".concat(parentName)}),react.createElement(index_es.b,versions_messages.versionsTitle))},react.createElement(loading_indicator.a,{className:"bcs-Versions-content",crawlerPosition:"top",isLoading:isLoading},!!error&&react.createElement(inline_error.a,{title:react.createElement(index_es.b,versions_messages.versionServerError)},react.createElement(index_es.b,error)),!isLoading&&!showVersions&&react.createElement("div",{className:"bcs-Versions-empty"},react.createElement(index_es.b,versions_messages.versionsEmpty)),showVersions&&react.createElement("div",{className:"bcs-Versions-menu"},react.createElement(versions_VersionsMenu,VersionsSidebar_extends({versions:versions},rest))),showLimit&&react.createElement("div",{className:"bcs-Versions-maxEntries","data-testid":"max-versions"},react.createElement(index_es.b,VersionsSidebar_extends({},versions_messages.versionMaxEntries,{values:{maxVersions:MAX_VERSIONS}})))))};VersionsSidebar_VersionsSidebar.displayName="VersionsSidebar";var versions_VersionsSidebar=VersionsSidebar_VersionsSidebar,fields=(__webpack_require__(40),__webpack_require__(61));function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function VersionsSidebarAPI_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var VersionsSidebarAPI_VersionsSidebarAPI=function VersionsSidebarAPI(_ref){var _this=this,api=_ref.api,fileId=_ref.fileId;!function VersionsSidebarAPI_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VersionsSidebarAPI),VersionsSidebarAPI_defineProperty(this,"fetchData",(function(){return Promise.all([_this.fetchFile(),_this.fetchVersions()]).then(_this.fetchVersionCurrent)})),VersionsSidebarAPI_defineProperty(this,"fetchDownloadUrl",(function(version){return new Promise((function(resolve,reject){return version?_this.api.getFileAPI().getDownloadUrl(_this.fileId,version,resolve,reject):reject(new Error("Could not find requested version"))}))})),VersionsSidebarAPI_defineProperty(this,"fetchFile",(function(){return new Promise((function(resolve,reject){return _this.api.getFileAPI().getFile(_this.fileId,resolve,reject,{fields:fields.e,forceFetch:!0})}))})),VersionsSidebarAPI_defineProperty(this,"fetchVersions",(function(){return new Promise((function(resolve,reject){return _this.api.getVersionsAPI(!1).getVersions(_this.fileId,resolve,reject)}))})),VersionsSidebarAPI_defineProperty(this,"fetchVersionCurrent",(function(_ref2){var _ref3=_slicedToArray(_ref2,2),fileResponse=_ref3[0],versionsResponse=_ref3[1],_fileResponse$file_ve=fileResponse.file_version,file_version=void 0===_fileResponse$file_ve?{}:_fileResponse$file_ve;return new Promise((function(resolve,reject){return _this.api.getVersionsAPI(!1).getVersion(_this.fileId,file_version.id,(function(currentVersionResponse){resolve([fileResponse,_this.api.getVersionsAPI(!1).addCurrentVersion(currentVersionResponse,versionsResponse,fileResponse)])}),reject)}))})),VersionsSidebarAPI_defineProperty(this,"fetchVersion",(function(versionId){return new Promise((function(resolve,reject){return _this.api.getVersionsAPI(!1).getVersion(_this.fileId,versionId,resolve,reject)}))})),VersionsSidebarAPI_defineProperty(this,"deleteVersion",(function(version){var _ref4=version||{},versionId=_ref4.id,_ref4$permissions=_ref4.permissions,permissions=void 0===_ref4$permissions?{}:_ref4$permissions;return new Promise((function(resolve,reject){return _this.api.getVersionsAPI(!1).deleteVersion({fileId:_this.fileId,permissions:permissions,successCallback:resolve,errorCallback:reject,versionId:versionId})}))})),VersionsSidebarAPI_defineProperty(this,"promoteVersion",(function(version){var _ref5=version||{},versionId=_ref5.id,_ref5$permissions=_ref5.permissions,permissions=void 0===_ref5$permissions?{}:_ref5$permissions;return new Promise((function(resolve,reject){return _this.api.getVersionsAPI(!1).promoteVersion({fileId:_this.fileId,permissions:permissions,successCallback:resolve,errorCallback:reject,versionId:versionId})}))})),VersionsSidebarAPI_defineProperty(this,"restoreVersion",(function(version){var _ref6=version||{},versionId=_ref6.id,_ref6$permissions=_ref6.permissions,permissions=void 0===_ref6$permissions?{}:_ref6$permissions;return new Promise((function(resolve,reject){return _this.api.getVersionsAPI(!1).restoreVersion({fileId:_this.fileId,permissions:permissions,successCallback:resolve,errorCallback:reject,versionId:versionId})}))})),this.api=api,this.fileId=fileId},api_context=__webpack_require__(3907);function VersionsSidebarContainer_typeof(obj){return(VersionsSidebarContainer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function VersionsSidebarContainer_extends(){return(VersionsSidebarContainer_extends=Object.assign||function(target){for(var source,i=1;i<arguments.length;i++)for(var key in source=arguments[i])Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key]);return target}).apply(this,arguments)}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?ownKeys(Object(source),!0).forEach((function(key){VersionsSidebarContainer_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}function VersionsSidebarContainer_slicedToArray(arr,i){return function VersionsSidebarContainer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VersionsSidebarContainer_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VersionsSidebarContainer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function VersionsSidebarContainer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function VersionsSidebarContainer_defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)(descriptor=props[i]).enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}function VersionsSidebarContainer_possibleConstructorReturn(self,call){return!call||"object"!==VersionsSidebarContainer_typeof(call)&&"function"!=typeof call?VersionsSidebarContainer_assertThisInitialized(self):call}function VersionsSidebarContainer_getPrototypeOf(o){return(VersionsSidebarContainer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function VersionsSidebarContainer_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function VersionsSidebarContainer_setPrototypeOf(o,p){return(VersionsSidebarContainer_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function VersionsSidebarContainer_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var VersionsSidebarContainer_VersionsSidebarContainer=function(_React$Component){function VersionsSidebarContainer(){var _getPrototypeOf2,_this;VersionsSidebarContainer_classCallCheck(this,VersionsSidebarContainer);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this=VersionsSidebarContainer_possibleConstructorReturn(this,(_getPrototypeOf2=VersionsSidebarContainer_getPrototypeOf(VersionsSidebarContainer)).call.apply(_getPrototypeOf2,[this].concat(args)))),"state",{isLoading:!0,isWatermarked:!1,versionCount:1/0,versionLimit:1/0,versions:[]}),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"window",window),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleActionDelete",(function(versionId){return _this.setState({isLoading:!0}),_this.api.deleteVersion(_this.findVersion(versionId)).then((function(){return _this.api.fetchVersion(versionId)})).then(_this.handleDeleteSuccess).then((function(){return _this.props.onVersionDelete(versionId)})).catch((function(){return _this.handleActionError(versions_messages.versionActionDeleteError)}))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleActionDownload",(function(versionId){return _this.api.fetchDownloadUrl(_this.findVersion(versionId)).then(iframe.a).then((function(){return _this.props.onVersionDownload(versionId)})).catch((function(){return _this.handleActionError(versions_messages.versionActionDownloadError)}))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleActionPreview",(function(versionId){_this.updateVersion(versionId),_this.props.onVersionPreview(versionId)})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleActionPromote",(function(versionId){return _this.setState({isLoading:!0}),_this.api.promoteVersion(_this.findVersion(versionId)).then(_this.api.fetchData).then(_this.handleFetchSuccess).then(_this.handlePromoteSuccess).then((function(){return _this.props.onVersionPromote(versionId)})).catch((function(){return _this.handleActionError(versions_messages.versionActionPromoteError)}))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleActionRestore",(function(versionId){return _this.setState({isLoading:!0}),_this.api.restoreVersion(_this.findVersion(versionId)).then((function(){return _this.api.fetchVersion(versionId)})).then(_this.handleRestoreSuccess).then((function(){return _this.props.onVersionRestore(versionId)})).catch((function(){return _this.handleActionError(versions_messages.versionActionRestoreError)}))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleActionError",(function(message){_this.setState({error:message,isLoading:!1})})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleDeleteSuccess",(function(data){var selectedVersionId=_this.props.versionId,versionId=data.id;_this.mergeResponse(data),versionId===selectedVersionId&&_this.updateVersionToCurrent()})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleRestoreSuccess",(function(data){_this.mergeResponse(data)})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleFetchError",(function(){_this.setState({error:versions_messages.versionFetchError,isLoading:!1,isWatermarked:!1,versionCount:0,versions:[]})})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handleFetchSuccess",(function(_ref){var _ref2=VersionsSidebarContainer_slicedToArray(_ref,2),fileResponse=_ref2[0],versionsResponse=_ref2[1],api=_this.props.api,version_limit=fileResponse.version_limit,isWatermarked=get_default()(fileResponse,"watermark_info.is_watermarked",!1),versionLimit=null!=version_limit?version_limit:1/0,versionsWithPermissions=api.getVersionsAPI(!1).addPermissions(versionsResponse,fileResponse)||{},versions=versionsWithPermissions.entries,versionCount=versionsWithPermissions.total_count;return _this.setState({error:void 0,isLoading:!1,isWatermarked:isWatermarked,versionCount:versionCount,versionLimit:versionLimit,versions:_this.sortVersions(versions)},_this.verifyVersion),[fileResponse,versionsResponse]})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"handlePromoteSuccess",(function(_ref3){var fileVersion=VersionsSidebarContainer_slicedToArray(_ref3,1)[0].file_version;fileVersion&&_this.updateVersion(fileVersion.id)})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"initialize",(function(){_this.api=new VersionsSidebarAPI_VersionsSidebarAPI(_this.props)})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"fetchData",(function(){_this.api.fetchData().then(_this.handleFetchSuccess).catch(_this.handleFetchError)})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"findVersion",(function(versionId){return _this.state.versions.find((function(version){return version.id===versionId}))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"getCurrentVersionId",(function(){var versions=_this.state.versions;return versions[0]?versions[0].id:null})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"mergeVersions",(function(newVersion){var versions=_this.state.versions,newVersionId=newVersion?newVersion.id:"";return versions.map((function(version){return version.id===newVersionId?merge_default()(_objectSpread({},version),newVersion):version}))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"mergeResponse",(function(data){var newVersions=_this.mergeVersions(data);_this.setState({error:void 0,isLoading:!1,versions:newVersions})})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"updateVersion",(function(versionId){var _this$props=_this.props,history=_this$props.history,match=_this$props.match;return history.push(Object(react_router.f)(match.path,_objectSpread({},match.params,{versionId:versionId})))})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"updateVersionToCurrent",(function(){_this.updateVersion(_this.getCurrentVersionId())})),VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_assertThisInitialized(_this),"verifyVersion",(function(){var _this$props2=_this.props,onVersionChange=_this$props2.onVersionChange,versionId=_this$props2.versionId,selectedVersion=_this.findVersion(versionId);selectedVersion?onVersionChange(selectedVersion,{currentVersionId:_this.getCurrentVersionId(),updateVersionToCurrent:_this.updateVersionToCurrent}):_this.updateVersionToCurrent()})),_this}return function VersionsSidebarContainer_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&VersionsSidebarContainer_setPrototypeOf(subClass,superClass)}(VersionsSidebarContainer,_React$Component),function VersionsSidebarContainer_createClass(Constructor,protoProps,staticProps){return protoProps&&VersionsSidebarContainer_defineProperties(Constructor.prototype,protoProps),staticProps&&VersionsSidebarContainer_defineProperties(Constructor,staticProps),Constructor}(VersionsSidebarContainer,[{key:"componentDidMount",value:function componentDidMount(){this.initialize(),this.fetchData()}},{key:"componentDidUpdate",value:function componentDidUpdate(_ref5){var prevFileId=_ref5.fileId,prevVersionId=_ref5.versionId,_this$props3=this.props,fileId=_this$props3.fileId,versionId=_this$props3.versionId;fileId!==prevFileId&&this.refresh(),versionId!==prevVersionId&&this.verifyVersion()}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.onVersionChange(null)}},{key:"refresh",value:function refresh(){this.initialize(),this.setState({isLoading:!0},this.fetchData)}},{key:"sortVersions",value:function sortVersions(){var versions=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return _toConsumableArray(versions).sort((function(a,b){return Date.parse(b.created_at)-Date.parse(a.created_at)}))}},{key:"render",value:function render(){var _this$props4=this.props,fileId=_this$props4.fileId,parentName=_this$props4.parentName;return react_default.a.createElement(versions_VersionsSidebar,VersionsSidebarContainer_extends({fileId:fileId,onDelete:this.handleActionDelete,onDownload:this.handleActionDownload,onPreview:this.handleActionPreview,onPromote:this.handleActionPromote,onRestore:this.handleActionRestore,parentName:parentName},this.state))}}]),VersionsSidebarContainer}(react_default.a.Component);VersionsSidebarContainer_VersionsSidebarContainer.displayName="VersionsSidebarContainer",VersionsSidebarContainer_defineProperty(VersionsSidebarContainer_VersionsSidebarContainer,"defaultProps",{onVersionChange:noop_default.a,onVersionDelete:noop_default.a,onVersionDownload:noop_default.a,onVersionPreview:noop_default.a,onVersionPromote:noop_default.a,onVersionRestore:noop_default.a,parentName:""});var versions_VersionsSidebarContainer=flow_default()([react_router.g,api_context.b])(VersionsSidebarContainer_VersionsSidebarContainer);__webpack_require__.d(__webpack_exports__,"default",(function(){return versions_VersionsSidebarContainer})),__webpack_require__.d(__webpack_exports__,"VersionsSidebarComponent",(function(){return versions_VersionsSidebar}))}}]);
//# sourceMappingURL=versions-sidebar.5140005ed7e9fe749798.bundle.js.map